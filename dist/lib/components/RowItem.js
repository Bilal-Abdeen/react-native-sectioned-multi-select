var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireDefault(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _reactNative=require("react-native");var _lodash=require("lodash");var _RowSubItem=_interopRequireDefault(require("./RowSubItem"));var _ItemIcon=_interopRequireDefault(require("./ItemIcon"));var _helpers=require("../helpers");var _reactNativeSectionedMultiSelect=require("react-native-sectioned-multi-select");var _actionOrigins=require("react-native-sectioned-multi-select/lib/reducer/actionOrigins");var _this=this,_jsxFileName="/Users/renrizzolo/Documents/websites/react-native-sectioned-multi-select/lib/components/RowItem.js";if(_reactNative.Platform.OS==='android'&&_reactNative.UIManager.setLayoutAnimationEnabledExperimental){_reactNative.UIManager.setLayoutAnimationEnabledExperimental(true);}var shouldNotRerender=function shouldNotRerender(prevProps,nextProps){var getChildren=prevProps.getChildren,item=prevProps.item,childItemId=prevProps.childItemId,itemId=prevProps.itemId;if(nextProps.selectedItems!==prevProps.selectedItems){if(getChildren(item)&&getChildren(item).some(function(el){return!prevProps.selectedItems.includes(childItemId(el))&&nextProps.selectedItems.includes(childItemId(el));})){console.log('--row render: next !sub inc, prev sub !inc',prevProps.item);return false;}if(getChildren(item)&&getChildren(item).some(function(el){return prevProps.selectedItems.includes(childItemId(el))&&!nextProps.selectedItems.includes(childItemId(el));})){console.log('--row render: prev sub inc, next sub inc',prevProps.item);return false;}if(prevProps.selectedItems.includes(itemId(item))&&!nextProps.selectedItems.includes(itemId(item))){console.log('--row render: next !inc, prev !inc',prevProps.item);return false;}if(!prevProps.selectedItems.includes(itemId(item))&&nextProps.selectedItems.includes(itemId(item))){console.log('--row render: next inc, prev !inc',prevProps.item);return false;}}if(!(0,_lodash.isEqual)(prevProps.stylesFromContext,nextProps.stylesFromContext)){console.log('--row render: styles !== styles',prevProps.item);return false;}if(!(0,_lodash.isEqual)(prevProps.colors,nextProps.colors)){console.log('--row render: colors !== colors',prevProps.item);return false;}return true;};var RowItem=_react.default.memo(function(props){var _React$useState=_react.default.useState(false),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),toggled=_React$useState2[0],setToggled=_React$useState2[1];var _React$useState3=_react.default.useState(null),_React$useState4=(0,_slicedToArray2.default)(_React$useState3,2),subToggled=_React$useState4[0],setSubToggled=_React$useState4[1];var _React$useState5=_react.default.useState(null),_React$useState6=(0,_slicedToArray2.default)(_React$useState5,2),showChildItems=_React$useState6[0],setShowChildItems=_React$useState6[1];var item=props.item,highlightedChildren=props.highlightedChildren,_props$styles=props.styles,stylesFromProps=_props$styles===void 0?{}:_props$styles;var _useSMSContext=(0,_reactNativeSectionedMultiSelect.useSMSContext)(),customLayoutAnimation=_useSMSContext.customLayoutAnimation,readOnlyHeadings=_useSMSContext.readOnlyHeadings,animateDropDowns=_useSMSContext.animateDropDowns,_toggleItem=_useSMSContext._toggleItem,_toggleChildren=_useSMSContext._toggleChildren,searchTerm=_useSMSContext.searchTerm,styles=_useSMSContext.styles,colors=_useSMSContext.colors,getStyles=_useSMSContext.getStyles,itemId=_useSMSContext.itemId,childItemId=_useSMSContext.childItemId,getChildren=_useSMSContext.getChildren,showDropDowns=_useSMSContext.showDropDowns,expandDropDowns=_useSMSContext.expandDropDowns,selectedIconPosition=_useSMSContext.selectedIconPosition,itemIconPosition=_useSMSContext.itemIconPosition,parentsToggleChildrenOnly=_useSMSContext.parentsToggleChildrenOnly,itemNumberOfLines=_useSMSContext.itemNumberOfLines,displayKey=_useSMSContext.displayKey,selectedItems=_useSMSContext.selectedItems,iconKey=_useSMSContext.iconKey,Icon=_useSMSContext.iconRenderer,subItemsFlatListProps=_useSMSContext.subItemsFlatListProps,components=_useSMSContext.components;_react.default.useEffect(function(){if(expandDropDowns){setShowChildItems(true);}},[]);var itemSelected=_react.default.useMemo(function(){return selectedItems.includes(itemId(item));},[selectedItems]);var toggleItem=function toggleItem(item){_toggleItem(item,_actionOrigins.PARENT_ITEM);};var toggleSubItem=function toggleSubItem(item){var id=itemId(item);if(subToggled===itemId(item)){setSubToggled(false);}else{setSubToggled(id);}_toggleItem(item,_actionOrigins.CHILD_ITEM);};var toggleDropDown=function toggleDropDown(){var animation=customLayoutAnimation||_reactNative.LayoutAnimation.Presets.easeInEaseOut;animateDropDowns&&_reactNative.LayoutAnimation.configureNext(animation);setShowChildItems(!showChildItems);};var dropDownIsOpen=_react.default.useMemo(function(){if(searchTerm.length){return true;}if(showDropDowns){return showChildItems;}return true;},[searchTerm,showDropDowns,showChildItems]);var hasChildren=_react.default.useMemo(function(){var hasChildren=getChildren(item)&&getChildren(item).length>0;return hasChildren;});var dropDownOrToggle=function dropDownOrToggle(){if(readOnlyHeadings&&hasChildren&&showDropDowns){toggleDropDown();}else if(hasChildren&&parentsToggleChildrenOnly){setToggled(!toggled);_toggleChildren(item,false,toggled);}else{toggleItem(item);}};var renderSubItemFlatList=function renderSubItemFlatList(_ref){var subItem=_ref.item;return _react.default.createElement(components.RowSubItem,(0,_extends2.default)({_toggleSubItem:toggleSubItem,subItem:subItem,highlightedChildren:highlightedChildren,selectedItems:selectedItems,SelectedIcon:components.SelectedIcon,UnselectedIcon:components.UnselectedIcon,getStyles:getStyles,selectedIconPosition:selectedIconPosition},props,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:191,columnNumber:5}}));};var renderSelectedIcon=function renderSelectedIcon(){return itemSelected?_react.default.createElement(components.SelectedIcon,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:206,columnNumber:9}}):_react.default.createElement(components.UnselectedIcon,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:207,columnNumber:9}});};var hasDropDown=hasChildren&&showDropDowns;console.log('row render2',item);var selectedItemStyles=_react.default.useMemo(function(){return getStyles('selectedItem',{},stylesFromProps);},[stylesFromProps.selectedItem,styles.selectedItem,itemSelected]);var itemStyles=_react.default.useMemo(function(){return getStyles('item',{itemSelected:itemSelected},stylesFromProps);},[stylesFromProps.item,styles.item,itemSelected]);var itemWrapperStyles=_react.default.useMemo(function(){return getStyles('itemWrapper',{itemSelected:itemSelected},stylesFromProps);},[stylesFromProps.itemWrapper,styles.itemWrapper,itemSelected]);var itemIconStyles=_react.default.useMemo(function(){return getStyles('itemIcon',{itemSelected:itemSelected},stylesFromProps);},[stylesFromProps.itemIcon,styles.itemIcon,itemSelected]);var itemIconSelectedStyles=_react.default.useMemo(function(){return getStyles('itemIconSelected',{},stylesFromProps);},[stylesFromProps.itemIconSelected,styles.itemIconSelected]);var itemTextContainerStyles=_react.default.useMemo(function(){return getStyles('itemTextContainer',{itemSelected:itemSelected},stylesFromProps);},[stylesFromProps.itemTextContainer,styles.itemTextContainer,itemSelected]);var itemTextStyles=_react.default.useMemo(function(){return getStyles('itemText',{item:item,itemSelected:itemSelected},stylesFromProps);},[stylesFromProps.itemText,styles.itemText,itemSelected]);var selectedItemTextStyles=_react.default.useMemo(function(){return getStyles('selectedItemText',{item:item},stylesFromProps);},[stylesFromProps.selectedItemText,styles.selectedItemText]);var dropDownToggleIconWrapperStyles=_react.default.useMemo(function(){return getStyles('dropDownToggleIconWrapper',{isOpen:dropDownIsOpen},stylesFromProps);},[stylesFromProps.dropDownToggleIconWrapper,styles.dropDownToggleIconWrapper,dropDownIsOpen]);var descriptionTextStyles=_react.default.useMemo(function(){return getStyles('descriptionText',{item:item},stylesFromProps);},[stylesFromProps.descriptionText,styles.descriptionText]);return _react.default.createElement(_reactNative.View,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:257,columnNumber:5}},_react.default.createElement(_reactNative.View,{style:itemWrapperStyles,__self:_this,__source:{fileName:_jsxFileName,lineNumber:258,columnNumber:7}},_react.default.createElement(_reactNative.TouchableOpacity,{disabled:readOnlyHeadings&&!showDropDowns||item.disabled,onPress:dropDownOrToggle,style:[itemStyles,itemSelected&&selectedItemStyles],__self:_this,__source:{fileName:_jsxFileName,lineNumber:261,columnNumber:9}},selectedIconPosition==='left'&&renderSelectedIcon(),itemIconPosition==='left'&&iconKey&&item[iconKey]&&_react.default.createElement(_ItemIcon.default,{iconRenderer:Icon,iconKey:iconKey,icon:item[iconKey],style:[itemIconStyles,itemSelected&&itemIconSelectedStyles],__self:_this,__source:{fileName:_jsxFileName,lineNumber:271,columnNumber:13}}),_react.default.createElement(_reactNative.View,{style:itemTextContainerStyles,__self:_this,__source:{fileName:_jsxFileName,lineNumber:281,columnNumber:11}},_react.default.createElement(_reactNative.Text,{numberOfLines:itemNumberOfLines,style:[itemTextStyles,itemSelected&&selectedItemTextStyles],__self:_this,__source:{fileName:_jsxFileName,lineNumber:282,columnNumber:11}},item[displayKey]),item.description&&_react.default.createElement(_reactNative.Text,{style:descriptionTextStyles,__self:_this,__source:{fileName:_jsxFileName,lineNumber:291,columnNumber:32}},item.description)),itemIconPosition==='right'&&iconKey&&item[iconKey]&&_react.default.createElement(_ItemIcon.default,{iconRenderer:Icon,iconKey:iconKey,icon:item[iconKey],style:[itemIconStyles,itemSelected&&itemIconSelectedStyles],__self:_this,__source:{fileName:_jsxFileName,lineNumber:294,columnNumber:13}}),selectedIconPosition==='right'&&renderSelectedIcon()),hasDropDown&&_react.default.createElement(_reactNative.TouchableOpacity,{style:dropDownToggleIconWrapperStyles,onPress:toggleDropDown,__self:_this,__source:{fileName:_jsxFileName,lineNumber:307,columnNumber:11}},_react.default.createElement(components.DropDownToggleIcon,{isOpen:dropDownIsOpen,__self:_this,__source:{fileName:_jsxFileName,lineNumber:311,columnNumber:13}}))),getChildren(item)&&dropDownIsOpen&&_react.default.createElement(_reactNative.FlatList,(0,_extends2.default)({keyExtractor:function keyExtractor(item){return""+childItemId(item);},data:getChildren(item),extraData:selectedItems,ItemSeparatorComponent:components.SubItemSeparator,renderItem:renderSubItemFlatList,initialNumToRender:20},subItemsFlatListProps,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:316,columnNumber:9}})));},shouldNotRerender);var _default=RowItem;exports.default=_default;